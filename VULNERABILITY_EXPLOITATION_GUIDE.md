**Unrestricted File Upload with XSS**

* **Description:** The application accepts HTML file uploads without validation and serves them directly from the `/uploads/` directory in the same domain context, allowing stored Cross-Site Scripting (XSS) attacks. When victims visit uploaded HTML files, embedded JavaScript executes automatically, stealing session cookies, capturing keystrokes, and harvesting sensitive browser data.
* **Exploitation:** Attackers upload malicious HTML files containing JavaScript payloads through the forum's upload feature, then share the direct file URLs with victims. When victims access these URLs, the JavaScript executes immediately, compromising their sessions and potentially allowing complete account takeover.
* **Location:** `/upload` route and `/uploads/<filename>` file serving route.
* **Mitigation:** Implement strict file type validation allowing only safe file types (images, PDFs). Serve uploaded files with `Content-Disposition: attachment` headers to prevent execution. Implement Content Security Policy (CSP) headers and serve uploads from a separate domain.

**2. A03:2021 Injection - PHP Remote Code Execution (RCE)**

* **Description:** The application accepts PHP file uploads without restriction and processes them as executable scripts rather than static files. This allows attackers to upload PHP web shells that can execute arbitrary system commands on the server when accessed through a web browser, providing complete server-side control.
* **Exploitation:** Attackers create PHP files containing web shell functionality that accepts commands via GET parameters and executes them using functions like `shell_exec()` or `system()`. After uploading through the forum, they access the file at `/uploads/exploit.php?cmd=whoami` to execute commands directly on the server.
* **Location:** `/upload` route and PHP file execution in `/uploads/` directory.
* **Mitigation:** Implement whitelist-based file extension validation excluding executable file types. Disable PHP execution in the uploads directory through web server configuration. Scan uploaded files for malicious content and rename files to prevent direct execution.

## Impact Assessment

Both vulnerabilities represent critical security flaws that can lead to:
- Complete session hijacking and account takeover (XSS)
- Full server compromise and system control (PHP RCE)
- Data theft and unauthorized access to sensitive information
- Potential lateral movement to other systems on the network
- Reputation damage and legal compliance issues 